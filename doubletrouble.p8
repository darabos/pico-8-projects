pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
t=0
pathlength=10
function initpath()
 local p={}
 for i=1,pathlength do
  add(p,{x=0,y=0})
 end
 return p
end
p={x=0,y=0,flip=false,spr=2,form=1,path=initpath()}
forms={2,3,4,5,18,24,19}
names={
 "doubly","cimi","rooty",
 "snake","mrs irma","mushroom",
 "sara"}
friends={}
villagers={}
for i=3,5 do
 add(friends,{x=0,y=0,flip=false,spr=i,path=initpath()})
end
for i=18,19 do
 add(villagers,
 {x=i*10-140,y=50,flip=true,spr=i,
  says=function(me)
   local n=names[p.form]
   return "hello "..n
  end})
end
music(4)
function _draw()
 cls(0)
 map(0)
 spr(p.spr,p.x,p.y,1,1,p.flip)
 foreach(friends,function(f)
  spr(f.spr,f.x,f.y,1,1,f.flip)
 end)
 foreach(villagers,function(f)
  spr(f.spr,f.x,f.y,1,1,f.x-p.x>0)
  if f.says then
   local d2=(f.x-p.x)^2+(f.y-p.y)^2
   if d2<100 then
    print(f.says(),f.x+6,f.y-6,0)
    print(f.says(),f.x+5,f.y-7,7)
   end
  end
 end)
end
function _update()
 t+=1
 if btnp(❎) then
  p.form=(p.form)%#forms+1
  sfx(2)
 end
 p.spr=forms[p.form]
 if (btn(⬅️)) then
  p.x-=1
  p.flip=true
 end
 if (btn(➡️)) then
  p.x+=1
  p.flip=false
 end
 if (btn(⬇️)) p.y+=1
 if (btn(⬆️)) p.y-=1
 if p.x==p.path[pathlength].x and
    p.y==p.path[pathlength].y then
  if (p.form==6) p.spr=8
 end
 addpath(p)
 local f0=p
 foreach(friends,function(f)
  local p=f0.path[1]
  if (p.x<f.x) f.flip=true
  if (p.x>f.x) f.flip=false
  f.x=f0.path[1].x
  f.y=f0.path[1].y
	 addpath(f)
  f0=f
 end)
 foreach(villagers,function(f)
  if t%10==0 and rnd()<0.3 then
   f.x+=3*rnd()-1.5
   f.y+=3*rnd()-1.5
  end
  f.x=mid(0,f.x,100)
  f.y=mid(0,f.y,100)
 end)
end
function addpath(p)
 if p.x!=p.path[pathlength].x or
    p.y!=p.path[pathlength].y then
  del(p.path,p.path[1])
  add(p.path,{x=p.x,y=p.y})
 end
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000aaaaa0000000000000000000000cc0000000000066000000000000000000000000000000000000000000000000000000000000000000000
00700700070070000abbbb0044444440000000000000bb0000000000666000000000000000000000000000000000000000000000000000000000000000000000
00077000007700000a3bb3004bbbbb400003bb000000bb0000000006556600000000000000000ab3aa3000000000000000000000000000000000000000000000
00077000007700000abbbb0043bbb340003bb3b00000b0000000006544660000007887800000bab3ab3330000000000000000000000000000000000000000000
00700700070070000b5555b04bbbbb40003bbbb00b00b3000000065444566000088788880000ab33333a30000000000000000000000000000000000000000000
00000000000000000a555500022222000000b00000b3b0000000655444566000000555000000333b3b3bb000070000b000000000000000000000000000000000
00000000000000000050050002000200000bbb000000c00000065555555566000006660000aab3ab3b33300000b0b0b000000000000000000000000000000000
0000000000000000007777000000000000000000000000000065445444546600000000000a33b333333bb0000000000000000000000000000000000000000000
000000000000000000bbbb000000000000000000000000000654445444545660000000000bb3333bbb3b30000000000000000000000000000000000000000000
0000000000000000003bb30000eaaaa0000000000000000006949494949496600000000000333033333000000000000000000000000000000000000000000000
000000000000000000bbbb4000abbbb0000000000000000000444444444440000088888000000055555000000000000000000000000000000000000000000000
00000000000000000bbccbb0aaa3bb30000000000000000000999955559990000887878800000004444000000000000000000000000000000000000000000000
000000000000000000cccc40e00bbbb0000000000000000000955944449990000005550000000005450000000000000000000000000000000000000000000000
00000000000000000ccccc40a02222220000000000000000009dd944549990000006660000000044450000000000000000000000000000000000000000000000
00000000000000000ccccc4002222222000000000000000000999944449990000006060000000045444400000000000000000000000000000000000000000000
__map__
0000000000000000000000000000090a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000b00191a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000607000000090a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000607001617000000191a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000b1617000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000006070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000b161700090a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000b191a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000006070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000016170000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000b00000000090a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000b00000607060700191a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000001617161708000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
01100000180501a0501c0501d0501f0501f05018050000001d0501d0001d0501d0001a0501d0001f00018000180501a0501c0501d0501f0501f05018050000001f050000001d0500000018050000000000000000
951000000c120001000c120001000c1200010013120001001312000100131200010013120001000c120001000c120001000c120001000c1200010013120001001112000100111200010013120001000c12000000
00080000131501115007150001500015000150001501110016100171001c1001e10024100281002a1000010000100001000010000100001000010000100001000010000100001000010000100001000010000100
011000002112500005211250000521125000051f125000051c125000051f12500005181250000500005000052112500005211252112521125000051f1250000524125000051f1250000018125000050000500000
000100003f750236502935005150071500d150101501215013150141501615017150181501b15021150391503f15000000000000355000000314503f250000000000002550000003f0503f050000000000000000
000100003f6503f6503f6503f6503f6503f65000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003f7503f7503f7503f7503f7503f750
00010000000000e050160501e050260502c05031050360503b0503c05035050320502f0502d0502d0502f05033050370503c0503c0503b05039050380503605034050300502d0502b05029050290502c05033050
00010000141501f150271502f150381503c1503f15000000000000000000000000003f1503b1503915034150321502f150000002d1502a150271502515023150211501f1501e1501d1501d1501d1501d1501d150
000100000b2500b2500b250000000b25000000000000b250000000a250000000000007250000000000003250000000000000250000000000000000000000000000000000000000000000000000e2500000000000
000100000335007350000000000000000113500000000000000000000000000000001a3500000000000000000000000000000001e350000000000000000000000000000000000001f3500b3500f3500e35006350
000100000000000000000000000000000174501745017450194502e4502f4502f4502f450214502f4501c450304502b4501e450314502b450324502b45032450324502b450000000000032450000000000036450
000100000000000000075500a550000000000000000000000000030550000001a5502655000000000000000000000000000000000000000000000000000000002f55000000285500000000000000000000000000
0001000000000000002f6503f65008650000003d65000000000003365000000000000000000000236500000000000000000000010650196501565011650126500e6500b650066500a650096500e6500000000000
000100003f7503f7503f7503f7503f7503e7503e7503f7503e7503e7503d7503f7503f7503f7503f7503f7503f7503f7503f7503d7503f7503e7503c7503d7503d7503d7503c7503e7503f7503b7503e75000000
000100003f3500000000000000003f3503f3503f3503f3503f3503f3503f3503f3503f3503f3503f3503f3503f3503f3503f3503f350000003e35000000000000000000000000000000000000000000000000000
011000001a0501a0501a0501a0501a0501a0501a0501a0501c0501c0501c0501c0501a0501a0501a0501a0501c0501c0501c0501c0501c0501c0501c0501c0500000000000000000000000000000000000000000
011000001f0501f0501f0501f0501f0501f0501f0501f0501f0501f0501f0501f0501f0501f0501f0501f05023050230502305023050230502305023050230500000000000000000000000000000000000000000
011000002605026050260502605026050260502605026050280502805028050280502605026050260502605028050280502805028050280502805028050280500000000000000000000000000000000000000000
01100000000001505521055210551c055000001c0551a0501a0501c0501c0501c0500000000000000000000000000000001505515055180501a0501a0551c0551c0501c050000000000000000000000000000000
0110000000000000001a0501a0551a0501a05518055180501805017050170551705517055180551a0551c0501c0501c0500000000000000000000000000000000000000000000000000000000000000000000000
0510000009050100500905010050090501005009050100500905010050090501005009050100500905010050050500c050050500c050050500c050050500c050050500c050050500c050050500c050050500c050
05100000070500e050070500e050070500e050070500e050070500e050070500e050070500e050070500e050040500b050040500b050040500b050040500b050040500b050040500b050040500b050040500b050
01100000000001501521055210551c0551c0501c0551a0501a0551c0501c050000000000000000000000000000000000001505515055180551a0501a0551c0551c0501c050000000000000000000000000000000
0110000000000000001a0501a0551a0501a05518055180501805517050170501705517055180551a0551c0501c0501c0500000000000000000000000000000000000000000000000000010050100501305015055
05100000070500e050070500e050070500e050070500e050070500e050070500e050070500e050070500e050040500b050040500b050040500b050040500b050040500405004050040501c0501c0501f05021055
0110000015050000000000000000150501505017050180551805000000000001005510050100501305015055110500000000000000001d0501d0501c0501a0501a0501a0501c0501c0501805518050180501a050
011000002105000000000000000018050180501a0501c0551c05000000000001c0551c0501c0501f050210501d050000000000000000260502605024050230502305023050240502405524050240552405026050
011000001705517055170551805017050170551705015050150501305513055130551305513055130551505017055170501705017050000000000000000000000000000000000000000000000000000000000000
01100000000000905515050150501005010055100500e0500e0551005010050100500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01100000000000e0550e0550e0550e0500e0550c0550c0500c0550b0500b0550b0550b0550c0550e0551005010055120501205014050140501505015050170501705017050170501705010050100501305015050
0110000009000170551705517055170501705515055150501505513050130551705517055180551a0551c0501c0551e0501e0502005020050210502105023050230502305023050230501c0501c0501f05021050
0110000017055170551705518050170501705517050150501505013055130551305513055130551305515050170551705017050170551c5501a550185501a5501c0501c0501c0501c05010050100501305015050
0110000015050000020000200002090520905209052090520b0520b0520b0520b0520c0520c0520c0520c0520e0520e0520e0520e0520c0520c0520c0520c0520e0520e0520e0520e05210052100521005210052
011000001505209052090520905209052090520905209052000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
01 00014344
00 00014344
02 03014344
01 0f101144
01 12144344
00 13154344
00 16144344
00 17184344
00 191a1444
00 1b154344
00 16144344
00 13154344
00 16144344
00 1d181e44
00 191a1444
00 1f154344

